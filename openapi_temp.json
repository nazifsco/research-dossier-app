{"openapi":"3.1.0","info":{"title":"Research Dossier API","description":"API for generating comprehensive research dossiers on companies and people.","version":"v1"},"paths":{"/api/auth/register":{"post":{"tags":["Authentication"],"summary":"Register","description":"Register a new user account.\nReturns access token on successful registration.","operationId":"register_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/login":{"post":{"tags":["Authentication"],"summary":"Login","description":"Login with email and password.\nReturns access token on success.","operationId":"login_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/me":{"get":{"tags":["Authentication"],"summary":"Get Me","description":"Get current authenticated user's profile.","operationId":"get_me_api_auth_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/auth/logout":{"post":{"tags":["Authentication"],"summary":"Logout","description":"Logout current user.\nNote: With JWT, logout is client-side (discard token).\nThis endpoint exists for API completeness and future token blacklisting.","operationId":"logout_api_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/api/research":{"post":{"tags":["Research"],"summary":"Create Research Job","description":"Create a new research job.\nDeducts credits and starts async processing.","operationId":"create_research_job_api_research_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateResearchRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResearchJobResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Research"],"summary":"List Research Jobs","description":"List user's research jobs.\nOptionally filter by status.","operationId":"list_research_jobs_api_research_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"status_filter","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status Filter"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResearchJobListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/research/{job_id}/download":{"get":{"tags":["Research"],"summary":"Download Report","description":"Download the report HTML for a completed job.\nAccepts token as query param for direct browser downloads.\nNOTE: This route MUST be defined BEFORE /{job_id} to ensure proper matching.","operationId":"download_report_api_research__job_id__download_get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}},{"name":"token","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Token"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/research/{job_id}":{"delete":{"tags":["Research"],"summary":"Delete Research Job","description":"Delete a research job.\nOnly allows deletion of completed or failed jobs (not pending/processing).\nNOTE: This route MUST be defined BEFORE GET /{job_id} to ensure proper matching.","operationId":"delete_research_job_api_research__job_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Research"],"summary":"Get Research Job","description":"Get details of a specific research job.","operationId":"get_research_job_api_research__job_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResearchJobDetailResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/payments/create-checkout":{"post":{"tags":["Payments"],"summary":"Create Checkout","description":"Create a Stripe checkout session for purchasing credits.","operationId":"create_checkout_api_payments_create_checkout_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateCheckoutRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CheckoutResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/payments/webhook":{"post":{"tags":["Payments"],"summary":"Stripe Webhook","description":"Handle Stripe webhooks for payment completion.","operationId":"stripe_webhook_api_payments_webhook_post","parameters":[{"name":"Stripe-Signature","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stripe-Signature"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/payments/history":{"get":{"tags":["Payments"],"summary":"Get Payment History","description":"Get user's payment history.","operationId":"get_payment_history_api_payments_history_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PaymentHistoryResponse"},"title":"Response Get Payment History Api Payments History Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/payments/tiers":{"get":{"tags":["Payments"],"summary":"Get Pricing Tiers","description":"Get available pricing tiers.","operationId":"get_pricing_tiers_api_payments_tiers_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/users/credits":{"get":{"tags":["Users"],"summary":"Get Credits","description":"Get user's credit balance and pending jobs count.","operationId":"get_credits_api_users_credits_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreditBalanceResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/users/profile":{"patch":{"tags":["Users"],"summary":"Update Profile","description":"Update user profile.","operationId":"update_profile_api_users_profile_patch","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProfileRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/users/change-password":{"post":{"tags":["Users"],"summary":"Change Password","description":"Change user's password.","operationId":"change_password_api_users_change_password_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangePasswordRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/":{"get":{"summary":"Root","description":"Health check endpoint.","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health","description":"Detailed health check.","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ChangePasswordRequest":{"properties":{"current_password":{"type":"string","title":"Current Password"},"new_password":{"type":"string","maxLength":100,"minLength":8,"title":"New Password"}},"type":"object","required":["current_password","new_password"],"title":"ChangePasswordRequest"},"CheckoutResponse":{"properties":{"checkout_url":{"type":"string","title":"Checkout Url"},"session_id":{"type":"string","title":"Session Id"}},"type":"object","required":["checkout_url","session_id"],"title":"CheckoutResponse"},"CreateCheckoutRequest":{"properties":{"tier":{"type":"string","title":"Tier"}},"type":"object","required":["tier"],"title":"CreateCheckoutRequest"},"CreateResearchRequest":{"properties":{"target":{"type":"string","maxLength":500,"minLength":1,"title":"Target"},"target_type":{"type":"string","pattern":"^(company|person)$","title":"Target Type"},"depth":{"type":"string","pattern":"^(quick|standard|deep)$","title":"Depth","default":"standard"}},"type":"object","required":["target","target_type"],"title":"CreateResearchRequest"},"CreditBalanceResponse":{"properties":{"credits":{"type":"integer","title":"Credits"},"pending_jobs":{"type":"integer","title":"Pending Jobs"}},"type":"object","required":["credits","pending_jobs"],"title":"CreditBalanceResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["email","password"],"title":"LoginRequest"},"PaymentHistoryResponse":{"properties":{"id":{"type":"string","title":"Id"},"amount_cents":{"type":"integer","title":"Amount Cents"},"credits_purchased":{"type":"integer","title":"Credits Purchased"},"status":{"type":"string","title":"Status"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","amount_cents","credits_purchased","status","created_at"],"title":"PaymentHistoryResponse"},"ProfileResponse":{"properties":{"id":{"type":"string","title":"Id"},"email":{"type":"string","title":"Email"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"credits":{"type":"integer","title":"Credits"},"is_verified":{"type":"boolean","title":"Is Verified"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","email","name","credits","is_verified","created_at"],"title":"ProfileResponse"},"RegisterRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","maxLength":100,"minLength":8,"title":"Password"},"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name"}},"type":"object","required":["email","password","name"],"title":"RegisterRequest"},"ResearchJobDetailResponse":{"properties":{"id":{"type":"string","title":"Id"},"target":{"type":"string","title":"Target"},"target_type":{"type":"string","title":"Target Type"},"depth":{"type":"string","title":"Depth"},"status":{"type":"string","title":"Status"},"credits_used":{"type":"integer","title":"Credits Used"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"created_at":{"type":"string","title":"Created At"},"started_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Started At"},"completed_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Completed At"},"report_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Report Url"}},"type":"object","required":["id","target","target_type","depth","status","credits_used","error_message","created_at","started_at","completed_at","report_url"],"title":"ResearchJobDetailResponse"},"ResearchJobListResponse":{"properties":{"jobs":{"items":{"$ref":"#/components/schemas/ResearchJobResponse"},"type":"array","title":"Jobs"},"total":{"type":"integer","title":"Total"}},"type":"object","required":["jobs","total"],"title":"ResearchJobListResponse"},"ResearchJobResponse":{"properties":{"id":{"type":"string","title":"Id"},"target":{"type":"string","title":"Target"},"target_type":{"type":"string","title":"Target Type"},"depth":{"type":"string","title":"Depth"},"status":{"type":"string","title":"Status"},"credits_used":{"type":"integer","title":"Credits Used"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"created_at":{"type":"string","title":"Created At"},"started_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Started At"},"completed_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Completed At"}},"type":"object","required":["id","target","target_type","depth","status","credits_used","error_message","created_at","started_at","completed_at"],"title":"ResearchJobResponse"},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In"}},"type":"object","required":["access_token","expires_in"],"title":"TokenResponse"},"UpdateProfileRequest":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name"}},"type":"object","title":"UpdateProfileRequest"},"UserResponse":{"properties":{"id":{"type":"string","title":"Id"},"email":{"type":"string","title":"Email"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"credits":{"type":"integer","title":"Credits"},"is_verified":{"type":"boolean","title":"Is Verified"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["id","email","name","credits","is_verified","created_at"],"title":"UserResponse"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}